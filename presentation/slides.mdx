import { dark } from '@mdx-deck/themes';
import prism from '@mdx-deck/themes/syntax-highlighter-prism'
import aspect from '@mdx-deck/themes/aspect'
import { Image, Box, Flex, Heading, Text } from 'rebass';

import reactImage from './images/react.png';
import loveImage from './images/love.png';
import wordpressImage from './images/wordpress.png';
import gutenbergImage from './images/gutenberg.png';
import gutenbergProfileImage from './images/gutenberg-profile.jpg';
import customBlockImage from './images/simple-post.png';

export const themes = [dark, prism, aspect];

# NextPress
### Headless WordPress and Next.js
###### Ivica BatiniÄ‡

---

# ðŸ’¡ Idea!

---

<Flex width="90%" justifyContent="center" alignItems="center">
  <Box width={300}>
    <img src={wordpressImage} />
  </Box>
  <Box width={200}>
    <img src={loveImage} />
  </Box>
  <Box width={300}>
    <img src={reactImage} />
  </Box>
</Flex>

---

## Gutenberg
<Image src={gutenbergProfileImage} width={200} height={200} />

---

## Gutenberg
<Image src={gutenbergImage} width={200} height={200} sx={{ backgroundColor: 'text' }}/>

---

<Box width="90%">
  <img src={customBlockImage} />
</Box>

---

<Text fontSize={74}>ðŸ¤”</Text>
<Heading fontSize={6} textAlign="center">
Can we reuse that component
<br/>on the frontend?
</Heading>

---

# ðŸ§³ Journey

---

## Monorepo

- need it to be a monorepo
- yarn workspaces

---

## Workspace setup

```json
// package.json
{
  "private": true,
  "workspaces": [
    "backend",
    "frontend",
    "common"
  ]
}
```

---

```json
// common/package.json
{
  "name": "@nextpress/common",
  "version": "1.0.0",
}
```

---


```json
// frontend/package.json
{
  "dependencies": {
    "@nextpress/common": "1.0.0",
  }
}
```

---

## Setting up wordpress

modular way

<a href="https://roots.io/bedrock/">
  <svg class="svg" width="243" height="76" viewBox="0 0 243 76" xmlns="http://www.w3.org/2000/svg">
    <path
      d="M2.233 1L1 2.233v16.034l1.057 1.057 34.886-5.815L38 14.567v11.1l35.52-5.92 1.48-1.48V2.233L73.767 1H2.233zm.247 30.587L1 33.067v9.866l1.057 1.057L38 38V25.667l-35.52 5.92zM38 38v12.334l35.52-5.92 1.48-1.48v-9.867l-1.057-1.057L38 38zM2.48 56.253L1 57.733v16.034L2.233 75h71.534L75 73.767V57.733l-1.057-1.057-34.886 5.815L38 61.434v-11.1l-35.52 5.92zM120.94 43.78c0 5.32-3.8 7.22-7.6 7.22h-12.92l-.38-.38V24.78l.38-.38h12.16c3.8 0 7.6 1.9 7.6 6.84 0 2.66-1.14 4.94-3.8 5.7v.38c3.04.76 4.56 3.04 4.56 6.46zM114.86 32c0-1.9-.76-3.04-3.04-3.04h-6.08l-.38.38v5.32l.38.38h6.08c2.28 0 3.04-1.52 3.04-3.04zm.76 11.02c0-2.28-1.14-3.42-3.8-3.42h-6.08l-.38.38v6.08l.38.38h6.08c2.66 0 3.8-1.14 3.8-3.42zm26.22-1.52v1.52l-.38.38h-11.78l-.38.38c0 .76.76 3.04 3.8 3.04 1.14 0 2.28-.38 2.66-1.14l.38-.38h4.56l.38.38c-.38 2.28-2.28 5.7-7.98 5.7-6.46 0-9.5-4.56-9.5-9.88 0-5.32 3.04-9.88 9.12-9.88 6.08 0 9.12 4.56 9.12 9.88zm-6.08-1.9l.38-.38c0-.38-.38-3.04-3.42-3.04s-3.42 2.66-3.42 3.04l.38.38h6.08zm8.36 1.9c0-6.08 3.8-9.88 8.36-9.88 3.42 0 4.94 1.9 4.94 1.9h.38v-8.74l.38-.38h4.56l.38.38v25.84l-.38.38h-4.18l-.38-.38-.38-1.14h-.38s-1.52 1.9-4.94 1.9c-4.56 0-8.36-3.8-8.36-9.88zm5.32 0c0 3.04 1.14 5.32 4.18 5.32s4.18-2.28 4.18-5.32c0-3.04-1.14-5.32-4.18-5.32s-4.18 2.28-4.18 5.32zm30.78-5.32l-.38.38h-2.66c-3.04 0-4.18 1.52-4.18 4.94v9.12l-.38.38h-4.56l-.38-.38V32.38l.38-.38h4.18l.38.38.38 1.14h.38s.76-1.52 4.18-1.52h2.28l.38.38v3.8zm20.9 5.32c0 6.08-3.8 9.88-9.5 9.88s-9.5-3.8-9.5-9.88c0-6.08 3.8-9.88 9.5-9.88s9.5 3.8 9.5 9.88zm-5.32 0c0-3.42-1.52-5.32-4.18-5.32-2.66 0-4.18 1.9-4.18 5.32 0 3.42 1.52 5.32 4.18 5.32 2.66 0 4.18-1.9 4.18-5.32zm12.92 0c0 3.42 1.52 5.32 4.18 5.32 1.9 0 3.04-.76 3.42-1.9l.38-.38h4.56l.38.38c-.76 4.56-4.56 6.46-8.74 6.46-5.7 0-9.5-3.8-9.5-9.88 0-6.08 3.8-9.88 9.5-9.88 4.18 0 7.98 1.9 8.74 6.46l-.38.38h-4.56l-.38-.38c-.38-1.14-1.52-1.9-3.42-1.9-2.66 0-4.18 1.9-4.18 5.32zm33.44 9.12l-.38.38h-2.28l-.76-.38-5.32-5.7h-.38l-2.28 2.28-.38.76v2.66L230 51h-4.56l-.38-.38V24.78l.38-.38H230l.38.38v15.2h.38l7.6-7.6.76-.38h2.28l.38.38v3.8l-4.56 4.56v.38l4.94 5.7v3.8z"
      fill="#525DDC"
      fill-rule="evenodd"
    ></path>
  </svg>
</a>

<a href="https://wpackagist.org/">
  WordPress Packagist
</a>

---

```bash
# Create a new Bedrock project
$ composer create-project roots/bedrock

# Add plugins with Composer
$ composer require wpackagist-plugin/safe-redirect-manager
$ composer require wpackagist-plugin/simple-page-ordering
$ composer require wpackagist-plugin/woocommerce
```

---

## Docker

- Nginx, SSL, MariaDB
- [wordpress-nginx-docker-compose](https://github.com/urre/wordpress-nginx-docker-compose)

---

## Gutenberg blocks

- <img src={reactImage} width="36px" height="36px" /> React components
- read some documentation
  - [registerBlockType()](https://developer.wordpress.org/block-editor/developers/block-api/block-registration/)
  - [attributes/setAttributes](https://developer.wordpress.org/block-editor/developers/block-api/block-attributes/)
  - [edit and save](https://developer.wordpress.org/block-editor/developers/block-api/block-edit-save/)
  - [`<InspectorControls>`](https://github.com/WordPress/gutenberg/tree/master/packages/block-editor/src/components/inspector-controls)

---

## Gutenberg blocks Quickstart

- [create-guten-block](https://github.com/ahmadawais/create-guten-block)

---

## cgb downsides

- no support for Typescript
- no support for transpile modules

---

## Roll your own solution

- by coping others (cgb)
- started to write typings for Wordpress
- realises they already exists on npm
- but have weird names with __

`@types/wordpress__blocks`
[link](https://www.npmjs.com/package/@types/wordpress__blocks)

---

## Funny thing!

- [wordpress hooks](https://www.npmjs.com/package/@wordpress/hooks)
- [api-fetch](https://www.npmjs.com/package/@wordpress/api-fetch)

---

## Wordpress GraphQL

- amazed how good it is
- [wp-graphql](https://github.com/wp-graphql/wp-graphql)
- [wp-graphql-gutenberg](https://github.com/pristas-peter/wp-graphql-gutenberg)
- [wp-graphiql](https://github.com/wp-graphql/wp-graphiql) (playground)

---

# Frontend

- Next.js
- Apollo GraphQL Client
- next-transpile-modules plugin
- Blocks component (demo)
- SimplePost component (demo)

---

# What next?

- React Native
- [React Sketch.app](http://airbnb.io/react-sketchapp/)

---

# Thank you!

[https://github.com/isBatak/nextpress](https://github.com/isBatak/nextpress)

